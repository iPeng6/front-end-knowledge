# JavaScript æ‰‹å†Œ

å‚è€ƒ

- [the-complete-javascript-handbook](https://medium.freecodecamp.org/the-complete-javascript-handbook-f26b2c71719c) [[ä¸­æ–‡ 1]](https://www.css88.com/archives/9922) [[ä¸­æ–‡ 2]](https://juejin.im/post/5bff57fee51d45021a167991)
- [Learn ES2015](https://babeljs.io/docs/en/learn) [[ä¸­æ–‡ 1]](https://github.com/fengzilong/es6features-zhCN) [[ä¸­æ–‡ 2]](http://caibaojian.com/es6.html)
- [here-are-examples-of-everything-new-in-ecmascript-2016-2017-and-2018](https://medium.freecodecamp.org/here-are-examples-of-everything-new-in-ecmascript-2016-2017-and-2018-d52fa3b5a70e)

## ç®€ä»‹

JavaScript æ˜¯ä¸–ç•Œä¸Šæœ€æµè¡Œçš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸€ï¼Œç°åœ¨ä¹Ÿå¹¿æ³›ç”¨äºé™¤äº†æµè§ˆå™¨ä¹‹å¤–çš„å…¶ä»–åœ°æ–¹ã€‚ æ¯”å¦‚ Node.js åœ¨è¿‡å»å‡ å¹´ä¸­çš„å´›èµ·ï¼Œæ‰“ç ´äº†åç«¯å¼€å‘è¯­è¨€é¢†åŸŸ â€“ è¿™æ›¾ç»æ˜¯ Javaï¼ŒRubyï¼ŒPythonï¼ŒPHP å’Œä¼ ç»Ÿçš„æœåŠ¡å™¨ç«¯è¯­è¨€çš„å¤©ä¸‹ã€‚

JavaScript æ‰‹å†Œéµå¾ª 2/8 åŸåˆ™ï¼šåœ¨ 20ï¼… çš„æ—¶é—´å†…å­¦ä¹  80ï¼… çš„ JavaScriptã€‚

æœ¬æ‰‹å†Œæ—¨åœ¨è®©ä½ äº†è§£æœ‰å…³ JavaScript çš„æ‰€æœ‰çŸ¥è¯†ï¼

### JavaScript çš„åŸºæœ¬å®šä¹‰

JavaScript æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒæ˜¯ï¼š

- **é«˜çº§è¯­è¨€**ï¼šæä¾›çš„æŠ½è±¡ï¼Œå…è®¸æ‚¨å¿½ç•¥è¿è¡Œå®ƒçš„æœºå™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚å®ƒä½¿ç”¨åƒåœ¾æ”¶é›†å™¨è‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œå› æ­¤æ‚¨å¯ä»¥ä¸“æ³¨äºä»£ç ï¼Œè€Œä¸æ˜¯ç®¡ç†å†…å­˜ä½ç½®ï¼Œå¹¶ä¸”æä¾›äº†è®¸å¤šç»“æ„ï¼Œå…è®¸æ‚¨å¤„ç†åŠŸèƒ½å¼ºå¤§çš„å˜é‡å’Œå¯¹è±¡ã€‚
- **åŠ¨æ€è¯­è¨€**ï¼šä¸é™æ€ç¼–ç¨‹è¯­è¨€ç›¸åï¼ŒåŠ¨æ€è¯­è¨€åœ¨è¿è¡Œæ—¶æ‰§è¡Œè®¸å¤šé™æ€è¯­è¨€åœ¨ç¼–è¯‘æ—¶æ‰§è¡Œçš„æ“ä½œã€‚ è¿™æœ‰åˆ©æœ‰å¼Šï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¦‚åŠ¨æ€ç±»å‹ï¼ŒåæœŸç»‘å®šï¼Œåå°„ï¼Œå‡½æ•°å¼ç¼–ç¨‹ï¼Œå¯¹è±¡è¿è¡Œæ—¶æ›´æ”¹ï¼Œé—­åŒ…ç­‰ç­‰ã€‚
- **åŠ¨æ€ç±»å‹**ï¼šå˜é‡ä¸å¼ºåˆ¶æ‰§è¡Œç±»å‹ã€‚ æ‚¨å¯ä»¥å°†ä»»ä½•ç±»å‹çš„å€¼é‡æ–°åˆ†é…ç»™å˜é‡ï¼Œä¾‹å¦‚å°†æ•´æ•°åˆ†é…ç»™åŒ…å«å­—ç¬¦ä¸²çš„å˜é‡ã€‚
- **å¼±ç±»å‹**ï¼šä¸å¼ºç±»å‹ç›¸åï¼Œå¼±ï¼ˆæˆ–æ¾æ•£ï¼‰ç±»å‹çš„è¯­è¨€ä¸å¼ºåˆ¶æ‰§è¡Œå¯¹è±¡çš„ç±»å‹ã€‚è¿™å…è®¸æ›´å¤šçš„çµæ´»æ€§ï¼Œä½†æ˜¯åˆå°†ç±»å‹å®‰å…¨å’Œç±»å‹æ£€æŸ¥æ‹’ä¹‹é—¨å¤–ã€‚ï¼ˆè¿™ä¹Ÿæ­£æ˜¯ TypeScript å’Œ Flow æ­£åœ¨æ”¹è¿›çš„åœ°æ–¹ï¼‰
- **è§£é‡Šå‹**ï¼šå®ƒé€šå¸¸è¢«ç§°ä¸ºè§£é‡Šå‹è¯­è¨€ï¼Œè¿™æ„å‘³ç€å®ƒåœ¨ç¨‹åºè¿è¡Œä¹‹å‰ä¸éœ€è¦ç¼–è¯‘é˜¶æ®µï¼Œè¿™å’Œ C ï¼Œ Java æˆ– Go è¯­è¨€ä¸åŒã€‚å®é™…ä¸Šï¼Œå‡ºäºæ€§èƒ½åŸå› ï¼Œæµè§ˆå™¨åœ¨æ‰§è¡Œä¹‹å‰ä¼šç¼–è¯‘ JavaScript ï¼Œä½†è¿™å¯¹æ‚¨æ¥è¯´æ˜¯ä¸å¯æ„ŸçŸ¥çš„ï¼Œå› ä¸ºä¸æ¶‰åŠé¢å¤–çš„æ­¥éª¤ã€‚
- **å¤šèŒƒå¼**ï¼šè¯¥è¯­è¨€ä¸å¼ºåˆ¶æ‰§è¡Œä»»ä½•ç‰¹å®šçš„ç¼–ç¨‹èŒƒä¾‹ï¼Œä¸åƒ Java é‚£æ ·å¼ºåˆ¶ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæˆ–è€…åƒ C é‚£æ ·å¼ºåˆ¶å‘½ä»¤å¼ç¼–ç¨‹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨é¢å‘å¯¹è±¡çš„èŒƒä¾‹ç¼–å†™ JavaScript ï¼Œä½¿ç”¨åŸå‹å’Œæ–°çš„ï¼ˆä» ES6 å¼€å§‹ï¼‰ç±»(classes)è¯­æ³•ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹é£æ ¼ç¼–å†™ JavaScript ï¼Œä½¿ç”¨å…¶ä¸€ç­‰å‡½æ•°ï¼Œç”šè‡³ä»¥å‘½ä»¤å¼ï¼ˆC-likeï¼‰ç¼–å†™ã€‚

### JavaScript ç‰ˆæœ¬

æ¯å½“æ‚¨é˜…è¯» JavaScript ç›¸å…³å†…å®¹æ—¶ï¼Œæ‚¨å°†ä¸å¯é¿å…åœ°çœ‹åˆ°ä»¥ä¸‹ä¸€äº›æœ¯è¯­ï¼š

```
ES3ã€ES5ã€ES6ã€ES7ã€ES8ã€
ES2015ã€ES2016ã€ES2017ã€ES2018ã€
ECMAScript 2015ã€ECMAScript 2016ã€ECMAScript 2017ã€ECMAScript 2018
```

å•¥æ„æ€ï¼Ÿå…¶å®éƒ½æŒ‡çš„æ˜¯ ECMAScript çš„æ ‡å‡†ã€‚JavaScript æ˜¯ ECMAScript æ ‡å‡†çš„ä¸€ç§å®ç°ç®€ç§° ES ã€‚

é™¤ JavaScript å¤–ï¼Œä¹Ÿæœ‰å…¶ä»–è¯­è¨€å®ç°äº† ECMAScriptï¼ŒåŒ…æ‹¬ï¼š

- ActionScript ï¼ˆFlash è„šæœ¬è¯­è¨€ï¼‰ï¼Œè‡ª Flash å®£å¸ƒå°†äº 2020 å¹´æ­£å¼åœæ­¢ç»´æŠ¤ä»¥æ¥ï¼Œå®ƒçš„äººæ°”æ­£åœ¨ä¸‹é™ã€‚
- JScriptï¼ˆå¾®è½¯è„šæœ¬è¯­è¨€ï¼‰ï¼Œå› ä¸ºå½“æ—¶åªæœ‰ Netscape æ”¯æŒ JavaScript å¹¶ä¸”æµè§ˆå™¨å¤§æˆ˜è¾¾åˆ°é¡¶å³°ï¼Œå¾®è½¯å¿…é¡»ä¸º Internet Explorer æ„å»ºè‡ªå·±çš„è„šæœ¬è¯­è¨€ã€‚

å½“ç„¶ï¼ŒJavaScript ä»æ˜¯æœ€æµè¡Œå’Œå¹¿æ³›ä½¿ç”¨çš„ ES å®ç°ã€‚

**ä¸ºä½•ç”¨ä¸€ä¸ªè¿™ä¹ˆå¥‡æ€ªçš„åå­—ï¼Ÿ**

[Ecma International](/standard-specification/standard-organization/ecma) æ˜¯ç‘å£«æ ‡å‡†åä¼šï¼Œè´Ÿè´£åˆ¶å®šå›½é™…æ ‡å‡†ã€‚å½“ JavaScript è¢«åˆ›å»ºæ—¶ï¼Œå®ƒç”± Netscape å’Œ Sun Microsystems å‘ˆç»™ Ecmaï¼ŒEcma çš„æ ‡å‡†å¾ˆå¤šä¼šèµ·ä¸ªç¼–å·ï¼Œæ­£å¥½ç¼–å·åˆ° 262 å·ï¼Œå°±æŠŠåŸºäº JavaScript çš„æ ‡å‡†ç¼–ä¸º ECMA-262 ï¼Œåˆ«å ECMAScriptã€‚

**ä¸ºä½•ç‰ˆæœ¬å·æœ‰æ—¶æ•°å­—æœ‰æ—¶å¹´ä»½ï¼Ÿ**

åœ¨ ES2015 ä¹‹å‰ï¼ŒECMAScript è§„èŒƒé€šå¸¸æŒ‰å…¶ç‰ˆæœ¬å·å‘½åã€‚ å¦‚ ES5 å…¶å®æ˜¯ 2009 å¹´æ›´æ–°å‘å¸ƒçš„ ECMAScript è§„èŒƒçš„å®˜æ–¹åç§°ã€‚

ä» 2015 å¹´èµ·ï¼Œ[TC39](/standard-specification/standard-organization/tc39) å†³å®šæ¯å¹´å‘å¸ƒä¸€ä¸ªç‰ˆæœ¬ï¼Œä»¥å¹´å·ä½œä¸ºç‰ˆæœ¬å·ï¼Œä»¥é¿å…åœ¨ç‰ˆæœ¬ä¹‹é—´é—²ç½®å¤ªå¤šï¼Œå¹¶ä¸”åé¦ˆå¾ªç¯æ›´å¿«ã€‚ä½†ç¤¾åŒºä»ä¹ æƒ¯æ€§å°† ES2015 ç§°ä¸º ES6ï¼Œç±»æ¨ ES2016 ä¸º ES7 ç­‰ç­‰

![](img/esversion.png)

ES.Next å§‹ç»ˆæŒ‡å‘ JavaScript çš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬ã€‚

### æœ€æ–°ç‰ˆæœ¬

æœ€æ–°å‘å¸ƒç‰ˆæœ¬ï¼š[ECMA-262](http://www.ecma-international.org/ecma-262/)ï¼ŒECMAScript 2018ï¼Œ2018 å¹´ 6 æœˆå‘å¸ƒã€‚\
æœ€æ–°è‰ç¨¿ç‰ˆæœ¬ï¼š[tc39 ECMA-262](https://tc39.github.io/ecma262/)

## ES2015

### ç®€ä»‹

ECMAScript 2015 æ˜¯ 2015 å¹´ 6 æœˆè¢«æ‰¹å‡†çš„ ECMAScript æ ‡å‡†ã€‚

ES2015 æ˜¯è¯¥è¯­è¨€çš„ä¸€æ¬¡é‡å¤§æ›´æ–°ï¼Œè‡ª 2009 å¹´è¢«æ ‡å‡†åŒ–çš„ ES5 ä»¥æ¥çš„ä¸€æ¬¡æœ€ä¸»è¦æ›´æ–°ã€‚ä¸»è¦çš„ JavaScript å¼•æ“ä¹Ÿåœ¨å®ç°è¿™äº›ç‰¹æ€§ã€‚

æŸ¥çœ‹[ES2015 æ ‡å‡†](http://www.ecma-international.org/ecma-262/6.0/index.html)çš„æ‰€æœ‰è§„æ ¼

### ECMAScript 2015 ç‰¹æ€§

#### Arrows and Lexical This

ç®­å¤´å‡½æ•°æ˜¯ä½¿ç”¨ => è¯­æ³•çš„ç®€å†™å‡½æ•°ï¼Œæ”¯æŒè¡¨è¾¾å¼å’Œå¸¦å‡½æ•°ä½“çš„å†™æ³•ï¼Œä¸æ™®é€šå‡½æ•°ä¸åŒçš„æ˜¯ï¼Œç®­å¤´å‡½æ•°ä¸ä¸Šä¸‹æ–‡å…±äº«åŒä¸€ä¸ªè¯æ³• this, å¦‚æœç®­å¤´å‡½æ•°åœ¨å¦ä¸€ä¸ªå‡½æ•°é‡Œé¢é‚£ä¹ˆå®ƒå°†å…±äº«å®ƒçˆ¶çº§å‡½æ•°çš„â€œargumentsâ€å˜é‡

```js
// Expression bodies
var odds = evens.map(v => v + 1)
var nums = evens.map((v, i) => v + i)

// Statement bodies
nums.forEach(v => {
  if (v % 5 === 0) fives.push(v)
})

// Lexical this
var bob = {
  _name: 'Bob',
  _friends: [1],
  printFriends() {
    this._friends.forEach(f =>
      console.log(this._name + ' knows ' + f, this === bob),
    )
  },
}
bob.printFriends() // returns: Bob knows 1 true

// Lexical arguments
function square() {
  let example = () => {
    let numbers = []
    for (let number of arguments) {
      numbers.push(number * number)
    }

    return numbers
  }

  return example()
}
square(2, 4, 7.5, 8, 11.5, 21) // returns: [4, 16, 56.25, 64, 132.25, 441]
```

#### Classes

ES2015 classes åªæ˜¯ä¸€ç§åŸºäºåŸå‹çš„é¢å‘å¯¹è±¡æ¨¡å¼çš„è¯­æ³•ç³–ï¼Œç®€å•æ–¹ä¾¿çš„å£°æ˜å½¢å¼ä½¿å¾—ç±»æ¨¡å¼æ›´æ˜“ä½¿ç”¨ï¼Œä¹Ÿå¢åŠ äº†äº’æ“ä½œæ€§ã€‚ç±»æ”¯æŒåŸºäºåŸå‹çš„ç»§æ‰¿ã€super è°ƒç”¨ã€å®ä¾‹æ–¹æ³•ã€é™æ€æ–¹æ³•å’Œæ„é€ å‡½æ•°ã€‚

```js
class Person {
  constructor(name) {
    this.name = name
  }
  hello() {
    return 'Hello, I am ' + this.name + '.'
  }
}
class Actor extends Person {
  hello() {
    return super.hello() + ' I am an actor.'
  }
  static birth() {
    return new Person()
  }
  get fullName() {
    return `${this.firstName} ${this.lastName}`
  }
  set age(years) {
    this.theAge = years
  }
}
var tomCruise = new Actor('Tom Cruise')
tomCruise.hello()
```

#### Enhanced Object Literals

å¢å¼ºçš„å¯¹è±¡å­—é¢é‡ï¼Œæ”¯æŒæ„é€ æ—¶æŒ‡å®šåŸå‹`__proto__`, å±æ€§`handle: handle`èµ‹å€¼ç®€å†™ï¼Œæ–¹æ³•å®šä¹‰åŠ super è°ƒç”¨ï¼Œä½¿ç”¨è®¡ç®—å±æ€§åã€‚è¿™äº›åŠ èµ·æ¥ä½¿å¾—å­—é¢é‡è·Ÿç±»å£°æ˜æ›´ç›¸è¿‘ï¼ŒåŸºäºå¯¹è±¡çš„è®¾è®¡ä¹Ÿä»è¿™ç§ä¾¿åˆ©ä¸­è·ç›Šã€‚

```js
var obj = {
  // 1. Sets the prototype. "__proto__" or '__proto__' would also work.
  __proto__: theProtoObj,
  // Computed property name does not set prototype or trigger early error for
  // duplicate __proto__ properties.
  ['__proto__']: somethingElse,
  // 2. Shorthand for â€˜handler: handlerâ€™
  handler,
  // 3. Methods
  toString() {
    // 4. Super calls
    return 'd ' + super.toString()
  },
  // 5. Computed (dynamic) property names
  ['prop_' + (() => 42)()]: 42,
}
```

#### Template Strings

æ¨¡æ¿å­—ç¬¦ä¸²æä¾›äº†æ„å»ºå­—ç¬¦ä¸²çš„è¯­æ³•ç³–ã€‚è¿™ç±»ä¼¼äº Perlã€Python å’Œå…¶ä»–è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²æ’å€¼ç‰¹æ€§ã€‚æ­¤å¤–ï¼Œä½œä¸ºå¯é€‰é¡¹ï¼Œä½¿ç”¨æ ‡ç­¾å¯ä»¥è‡ªå®šä¹‰å­—ç¬¦ä¸²çš„æ„å»ºè¡Œä¸ºï¼Œé¿å…æ³¨å…¥æ”»å‡»ï¼Œæˆ–è€…åŸºäºå­—ç¬¦ä¸²æ„å»ºé«˜é˜¶çš„æ•°æ®ç»“æ„ã€‚

```js
// Basic literal string creation
const basic = `This is a pretty little template string.`

// Multiline strings
const multi = `In ES5 this is
 not legal.`

// Interpolate variable bindings
var name = 'Bob',
  time = 'today'
;`Hello ${name}, how are you ${time}?`

// Unescaped template strings
String.raw`In ES5 "\n" is a line-feed.`

// tag template

// Construct an HTTP request prefix is used to interpret the replacements and construction
tag`Hello ${a + b} world ${a * b}`
// the same as
tag(['Hello ', ' world ', ''], a + b, a * b)

GET`http://foo.org/bar?a=${a}&b=${b}
    Content-Type: application/json
    X-Credentials: ${credentials}
    { "foo": ${foo},
      "bar": ${bar}}`(myOnReadyStateChangeHandler)
```

#### Destructuring

è§£æ„å…è®¸ä½¿ç”¨æ¨¡å¼åŒ¹é…èµ‹å€¼ï¼Œæ”¯æŒæ•°ç»„å’Œå¯¹è±¡ã€‚è§£æ„æ˜¯ä¼šå¤±è´¥å¼±åŒ–çš„ï¼Œç±»ä¼¼å¯¹è±¡æŸ¥æ‰¾è¿‡ç¨‹ `foo['bar']`ï¼Œå¦‚æœæœªæ‰¾åˆ°åˆ™ç½®ä¸º undefined ä¹Ÿå¯ä»¥æŒ‡å®šé»˜è®¤å€¼ã€‚

```js
// list matching
var [a, , b] = [1, 2, 3]
a === 1
b === 3

// object matching
var {
  op: a,
  lhs: { op: b },
  rhs: c,
} = getASTNode()

// object matching shorthand
// binds `op`, `lhs` and `rhs` in scope
var { op, lhs, rhs } = getASTNode()

// Can be used in parameter position
function g({ name: x }) {
  console.log(x)
}
g({ name: 5 })

// Fail-soft destructuring
var [a] = []
a === undefined

// Fail-soft destructuring with defaults
var [a = 1] = []
a === 1

// Destructuring + defaults arguments
function r({ x, y, w = 10, h = 10 }) {
  return x + y + w + h
}
r({ x: 1, y: 2 }) === 23
```

#### Default + Rest + Spread

è¢«è°ƒå‡½æ•°æ”¯æŒè®¾ç½®å‚æ•°é»˜è®¤å€¼ï¼Œ`...` è¿ç®—ç¬¦å¯ä»¥å°†æ•°ç»„å±•å¼€æˆè¿ç»­çš„å‚æ•°ç»™å‡½æ•°è°ƒç”¨ï¼Œ`...` åœ¨å®šä¹‰å‡½æ•°æ—¶ä¹Ÿå¯ä»¥å°†å‰©ä½™çš„å‚æ•°æ”¶é›†æˆä¸€ä¸ªæ•°ç»„ï¼Œå‰©ä½™å‚æ•° Rest ä»£æ›¿äº†`arguments`çš„ä½¿ç”¨ï¼Œæ›´ç›´æ¥çš„è§£å†³å¸¸è§é—®é¢˜ã€‚

```js
// Default
function f(x, y = 12) {
  // y is 12 if not passed (or passed as undefined)
  return x + y
}
f(3) == 15

// Rest
function f(x, ...y) {
  // y is an Array
  return x * y.length
}
f(3, 'hello', true) == 6

// Spread
function f(x, y, z) {
  return x + y + z
}
// Pass each elem of array as argument
f(...[1, 2, 3]) == 6
```

#### Let + Const

let å’Œ const éƒ½æ˜¯ç»‘å®šæ„é€ çš„å—çº§ä½œç”¨åŸŸã€‚let æ˜¯æ–°çš„ varã€‚const æ˜¯å•æ¬¡èµ‹å€¼çš„ã€‚const çš„é™æ€é™åˆ¶ç¦æ­¢å˜é‡åœ¨èµ‹å€¼å‰ä½¿ç”¨ã€‚

```js
function f() {
  {
    let x
    {
      // this is ok since it's a block scoped name
      const x = 'sneaky'
      // error, was just defined with `const` above
      x = 'foo'
    }
    // this is ok since it was declared with `let`
    x = 'bar'
    // error, already declared above in this block
    let x = 'inner'
  }
}
```

#### Iterators + For..Of

Iterator å¯¹è±¡è®© javascript æ‹¥æœ‰äº†åƒ CLR IEnumerable å’Œ Java Iterable ä¸€æ ·è‡ªå®šä¹‰è¿­ä»£å™¨çš„èƒ½åŠ›ã€‚å°† for..in è½¬æ¢æˆåŸºäºè¿­ä»£å™¨çš„è‡ªå®šä¹‰éå†çš„ for..of å½¢å¼ã€‚ä¸éœ€è¦å®ç°ä¸€ä¸ªç±»ä¼¼ LINQ ä¸­æƒ°æ€§è®¾è®¡æ¨¡å¼çš„æ•°ç»„ã€‚

```js
let fibonacci = {
  [Symbol.iterator]() {
    let pre = 0,
      cur = 1
    return {
      next() {
        ;[pre, cur] = [cur, pre + cur]
        return { done: false, value: cur }
      },
    }
  },
}

for (var n of fibonacci) {
  // truncate the sequence at 1000
  if (n > 1000) break
  console.log(n)
}

// Getting the iterator from an array returns an iterator of values
const a = [1, 2, 3]
let it = a[Symbol.iterator]()
console.log(it.next().value) //1
console.log(it.next().value) //2
console.log(it.next().value) //3

//get the index as well, using `entries()`
for (const [i, v] of ['a', 'b', 'c'].entries()) {
  console.log(i, v)
}

for ([key, val] of Object.entries({ a: 1, b: 2 })) {
  console.log(key, val)
}
```

Iteration åŸºäº [duck-typed](https://en.wikipedia.org/wiki/Duck_typing) çš„æ¥å£(ä»¥ä¸‹ä½¿ç”¨ TypeScript çš„è¯­æ³•ï¼Œä»…ä¾›è§£é‡Šç”¨)

```js
interface IteratorResult {
  done: boolean;
  value: any;
}
interface Iterator {
  next(): IteratorResult;
}
interface Iterable {
  [Symbol.iterator](): Iterator
}
```

#### Generators

Generators ä½¿ç”¨ `function*` å’Œ `yield` çš„è¯­æ³•ç®€åŒ–äº†è¿­ä»£å™¨çš„ä¹¦å†™ã€‚ä¸€ä¸ªä½¿ç”¨ `function*` å£°æ˜çš„å‡½æ•°è¿”å›ä¸€ä¸ª Generator å®ä¾‹ã€‚Generators ä¹Ÿæ˜¯è¿­ä»£å™¨çš„ä¸€ç§ï¼Œä½†å®ƒæ‹¥æœ‰é¢å¤–çš„ next å’Œ throw æ–¹æ³•ã€‚è¿™å…è®¸å€¼å›åˆ° generator ä¸­ï¼Œæ‰€ä»¥ yield æ˜¯ä¸€ç§è¿”å›ï¼ˆæˆ–æŠ›å‡ºï¼‰å€¼çš„è¡¨è¾¾å¼å½¢å¼ã€‚

æ³¨æ„ï¼šå¯ä»¥ç”¨å®ƒæ¥è¿›è¡Œç±»ä¼¼â€˜awaitâ€™çš„å¼‚æ­¥ç¼–ç¨‹ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹ ES7 çš„ [await](https://github.com/lukehoban/ecmascript-asyncawait) ææ¡ˆ

```js
var fibonacci = {
  [Symbol.iterator]: function*() {
    var pre = 0,
      cur = 1
    for (;;) {
      var temp = pre
      pre = cur
      cur += temp
      yield cur
    }
  },
}

for (var n of fibonacci) {
  // truncate the sequence at 1000
  if (n > 1000) break
  console.log(n)
}
```

è¿™ä¸ª generator æ¥å£å®šä¹‰æ˜¯ï¼ˆä½¿ç”¨ TypeScript ç±»å‹è¯­æ³•å®šä¹‰æ¥è§£é‡Šï¼‰ï¼š

```ts
interface Generator extends Iterator {
  next(value?: any): IteratorResult
  throw(exception: any)
}
```

Unicode

æ”¯æŒå®Œæ•´ Unicode çš„éç ´åæ€§æ·»åŠ ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ä¸­æ–°çš„ unicode å­—é¢é‡å’Œæ–°çš„ RegExp `u` æ¨¡å¼æ¥å¤„ç†ç ä½ï¼ˆå­—ç¬¦åœ¨å­—ç¬¦é›†ä¸­çš„ä½ç½®ï¼‰ï¼Œä»¥åŠæ–°çš„ APIs åœ¨ [21bit ç ä½çº§åˆ«](https://zh.wikipedia.org/wiki/Unicode#.E7.BC.96.E7.A0.81.E6.96.B9.E5.BC.8F) ä¸Šå¤„ç†å­—ç¬¦ä¸²ï¼Œ
å¢åŠ è¿™äº›æ”¯æŒåå¯ä»¥ä½¿ç”¨ Javascript æ„å»ºå…¨çƒåŒ–åº”ç”¨ã€‚

```js
// same as ES5.1
'ğ ®·'.length == 2

// new RegExp behaviour, opt-in â€˜uâ€™
'ğ ®·'.match(/./u)[0].length == 2

// new form
;('\u{20BB7}' == 'ğ ®·') == '\uD842\uDFB7'

// new String ops
'ğ ®·'.codePointAt(0) == 0x20bb7

// for-of iterates code points
for (var c of 'ğ ®·') {
  console.log(c)
}
```

#### Modules

åœ¨ ES2015 ä¹‹å‰ï¼Œè‡³å°‘æœ‰ä¸‰ä¸ªä¸»è¦çš„æ¨¡å—æ ‡å‡†ç«äº‰ï¼Œè¿™äº›æ ‡å‡†ä½¿ç¤¾åŒºæ”¯ç¦»ç ´ç¢ï¼š

- AMD
- RequireJS
- CommonJS

ES2015 å°†è¿™äº›æ ‡å‡†åŒ–ä¸ºé€šç”¨çš„æ ¼å¼ï¼Œåœ¨è¯­è¨€å±‚é¢ä¸Šå¾—åˆ°äº†æ”¯æŒã€‚è¿è¡Œæ—¶è¡Œä¸ºç”±å®¿ä¸»åŠ è½½å™¨å®šä¹‰ï¼Œéšå¼å¼‚æ­¥æ¨¡å‹ - ç›´åˆ°å…¨éƒ¨è¯·æ±‚çš„æ¨¡å—å‡å¯ç”¨ä¸”ç»å¤„ç†åï¼Œæ‰ä¼šæ‰§è¡Œå½“å‰æ¨¡å—å†…çš„ä»£ç ã€‚

```js
// lib/math.js
export function sum(x, y) {
  return x + y
}
export var pi = 3.141593
```

```js
// app.js
import * as math from 'lib/math'
console.log('2Ï€ = ' + math.sum(math.pi, math.pi))
```

```js
// otherApp.js
import { sum, pi } from 'lib/math'
console.log('2Ï€ = ' + sum(pi, pi))
```

ä¸€äº›é¢å¤–çš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬ `export default` ä»¥åŠ `export *`

```js
// lib/mathplusplus.js
export * from 'lib/math'
export var e = 2.71828182846
export default function(x) {
  return Math.exp(x)
}
```

```js
// app.js
import exp, { pi, e } from 'lib/mathplusplus'
console.log('e^Ï€ = ' + exp(pi))
```

#### Map + Set + WeakMap + WeakSet

ç”¨äºå®ç°å¸¸è§ç®—æ³•çš„é«˜æ•ˆæ•°æ®ç»“æ„ï¼ŒWeakMaps æä¾›ä¸ä¼šæ³„éœ²çš„å¯¹è±¡é”®(å¯¹è±¡ä½œä¸ºé”®åï¼Œè€Œä¸”é”®åæŒ‡å‘å¯¹è±¡)ç´¢å¼•è¡¨ æ³¨ï¼šæ‰€è°“çš„ä¸ä¼šæ³„éœ²ï¼ŒæŒ‡çš„æ˜¯å¯¹åº”çš„å¯¹è±¡å¯èƒ½ä¼šè¢«è‡ªåŠ¨å›æ”¶ï¼Œå›æ”¶å WeakMaps è‡ªåŠ¨ç§»é™¤å¯¹åº”çš„é”®å€¼å¯¹ï¼Œæœ‰åŠ©äºé˜²æ­¢å†…å­˜æ³„éœ²

WeekSet ä¸ Set åŒºåˆ«ï¼š

1. WeakSet çš„æˆå‘˜åªèƒ½æ˜¯å¯¹è±¡ï¼Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹çš„å€¼
2. WeakSet ä¸­çš„å¯¹è±¡éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œå¦‚æœå…¶ä»–å¯¹è±¡éƒ½ä¸å†å¼•ç”¨è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶æœºåˆ¶éšæ—¶ä¼šå›æ”¶è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ï¼Œç”±äºåƒåœ¾å›æ”¶çš„ä¸å¯é¢„æµ‹æ€§ï¼Œæ‰€ä»¥ ES6 è§„å®š WeakSet ä¸å¯éå†ã€‚

WeekMap ä¸ Map åŒºåˆ«ï¼š

1. WeakMap åªæ¥å—å¯¹è±¡ä½œä¸ºé”®åï¼ˆnull é™¤å¤–ï¼‰ï¼Œä¸æ¥å—å…¶ä»–ç±»å‹çš„å€¼ä½œä¸ºé”®å
2. WeakMap çš„é”®åæ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œä¸è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œæ³¨æ„å¼±å¼•ç”¨çš„åªæ˜¯é”®åï¼Œè€Œä¸æ˜¯é”®å€¼ã€‚é”®å€¼ä¾ç„¶æ˜¯æ­£å¸¸å¼•ç”¨ã€‚

```js
// Sets
var s = new Set()
s.add('hello')
  .add('goodbye')
  .add('hello')
s.size === 2
s.has('hello') === true

// Maps
var m = new Map()
m.set('hello', 42)
m.set(s, 34)
m.get(s) == 34

// Weak Maps
var wm = new WeakMap()
wm.set(s, { extra: 42 })
wm.size === undefined

// Weak Sets
var ws = new WeakSet()
ws.add({ data: 42 })
// Because the added object has no other references, it will not be held in the set
// å› ä¸ºåŠ å…¥çš„å¯¹è±¡æ²¡æœ‰ä»»ä½•å¼•ç”¨ï¼Œå®ƒå°†ä¸è¢«ä¿ç•™åœ¨é›†åˆä¸­ï¼Œä¹Ÿå°±æ˜¯å¯èƒ½ä¼šæ¶ˆå¤±
```

#### Proxies

ä»£ç†å¯ä»¥åˆ›é€ ä¸€ä¸ªå…·å¤‡å®¿ä¸»å¯¹è±¡å…¨éƒ¨å¯ç”¨è¡Œä¸ºçš„å¯¹è±¡ã€‚å¯ç”¨äºæ‹¦æˆªã€å¯¹è±¡è™šæ‹ŸåŒ–ã€æ—¥å¿—/åˆ†æç­‰

```js
// Proxying a normal object
var target = {}
var handler = {
  get: function(receiver, name) {
    return `Hello, ${name}!`
  },
}

var p = new Proxy(target, handler)
p.world === 'Hello, world!'
```

```js
// Proxying a function object
var target = function() {
  return 'I am the target'
}
var handler = {
  apply: function(receiver, ...args) {
    return 'I am the proxy'
  },
}

var p = new Proxy(target, handler)
p() === 'I am the proxy'
```

æ‰€æœ‰è¿è¡Œæ—¶çº§åˆ«çš„å…ƒæ“ä½œéƒ½æœ‰å¯¹åº”çš„é™·é˜±ï¼ˆä½¿å¾—è¿™äº›æ“ä½œéƒ½å¯ä»¥è¢«ä»£ç†ï¼‰

```js
var handler =
{
  // target.prop
  get: ...,
  // target.prop = value
  set: ...,
  // 'prop' in target
  has: ...,
  // delete target.prop
  deleteProperty: ...,
  // target(...args)
  apply: ...,
  // new target(...args)
  construct: ...,
  // Object.getOwnPropertyDescriptor(target, 'prop')
  getOwnPropertyDescriptor: ...,
  // Object.defineProperty(target, 'prop', descriptor)
  defineProperty: ...,
  // Object.getPrototypeOf(target), Reflect.getPrototypeOf(target),
  // target.__proto__, object.isPrototypeOf(target), object instanceof target
  getPrototypeOf: ...,
  // Object.setPrototypeOf(target), Reflect.setPrototypeOf(target)
  setPrototypeOf: ...,
  // for (let i in target) {}
  enumerate: ...,
  // Object.keys(target)
  ownKeys: ...,
  // Object.preventExtensions(target)
  preventExtensions: ...,
  // Object.isExtensible(target)
  isExtensible :...
}
```

#### Symbols

Symbol èƒ½å¤Ÿå®ç°å¯¹è±¡çŠ¶æ€çš„è®¿é—®æ§åˆ¶ï¼Œå…è®¸ä½¿ç”¨ string(ä¸ ES5 ç›¸åŒ)æˆ– symbol ä½œä¸ºé”®æ¥è®¿é—®å±æ€§ã€‚Symbol æ˜¯ä¸€ä¸ªæ–°çš„åŸè¯­ç±»å‹ï¼Œå¯é€‰çš„ name å‚æ•°å¯ä»¥ç”¨äºè°ƒè¯•â€”â€”ä½†å¹¶ä¸æ˜¯æ ‡è¯†ç¬¦çš„ä¸€éƒ¨åˆ†ï¼ˆå“ªæ€•ä¸€æ ·çš„ name çš„ä¸¤ä¸ª Symbol ä¹Ÿæ˜¯ä¸ç­‰çš„ï¼‰ã€‚Symbol æ˜¯ç‹¬ä¸€æ— äºŒçš„(å¦‚åŒ gensymï¼ˆæ‰€äº§ç”Ÿçš„ç¬¦å·)ï¼Œä½†ä¸æ˜¯ç§æœ‰çš„ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥é€šè¿‡ç±»ä¼¼ Object.getOwnPropertySymbols çš„åå°„ç‰¹æ€§æš´éœ²å‡ºæ¥ã€‚

```js
(function() {

  // module scoped symbol
  var key = Symbol("key");

  function MyClass(privateData) {
    this[key] = privateData;
  }

  MyClass.prototype = {
    doStuff: function() {
      ... this[key] ...
    }
  };

  // Limited support from Babel, full support requires native implementation.
  typeof key === "symbol"
})();

var c = new MyClass("hello")
c["key"] === undefined
```

#### Subclassable Built-ins

ES2015 å†…å»ºå¯¹è±¡å¦‚ `Array`ã€`Date` å’Œ DOM `Elements` å¯è¢«å­ç±»åŒ–

```js
// User code of Array subclass
class MyArray extends Array {
  constructor(...args) {
    super(...args)
  }
}

var arr = new MyArray()
arr[1] = 12
arr.length == 2
```

#### Math + Number + String + Object APIs

è®¸å¤šæ–°åŠ åº“åŒ…æ‹¬ Math åº“ï¼Œ Array è½¬æ¢ helpers å’Œç”¨äºæ‹·è´çš„ Object.assign

```js
Number.EPSILON
Number.isInteger(Infinity) // false
Number.isNaN('NaN') // false

Math.acosh(3) // 1.762747174039086
Math.hypot(3, 4) // 5
Math.imul(Math.pow(2, 32) - 1, Math.pow(2, 32) - 2) // 2

'abcde'.includes('cd') // true
'abc'.repeat(3) // "abcabcabc"

Array.from(document.querySelectorAll('*')) // Returns a real Array
Array.of(1, 2, 3) // Similar to new Array(...), but without special one-arg behavior
;[0, 0, 0].fill(7, 1) // [0,7,7]
;[1, 2, 3].findIndex(x => x == 2) // 1
;['a', 'b', 'c'].entries() // iterator [0, "a"], [1,"b"], [2,"c"]
;['a', 'b', 'c'].keys() // iterator 0, 1, 2
;['a', 'b', 'c'].values() // iterator "a", "b", "c"

Object.assign(Point, { origin: new Point(0, 0) })
```

#### Binary and Octal Literals

åŠ å…¥äº†å¯¹äºŒè¿›åˆ¶(b)å’Œå…«è¿›åˆ¶(o)å­—é¢é‡çš„æ”¯æŒ

```js
0b111110111 === 503 // true
0o767 === 503 // true
```

#### Promises

Promise æ˜¯ç”¨æ¥è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹çš„åº“ï¼ŒPromise æ˜¯å¯¹ä¸€ä¸ªâ€œå°†æ¥å¯èƒ½ä¼šå˜å¾—å¯ç”¨â€çš„å€¼çš„ç¬¬ä¸€ç±»è¡¨ç¤ºï¼ŒPromise åœ¨ç°æœ‰çš„è®¸å¤š JavaScript åº“ä¸­ä½¿ç”¨

```js
function timeout(duration = 0) {
  return new Promise((resolve, reject) => {
    setTimeout(resolve, duration)
  })
}

var p = timeout(1000)
  .then(() => {
    return timeout(2000)
  })
  .then(() => {
    throw new Error('hmm')
  })
  .catch(err => {
    return Promise.all([timeout(100), timeout(200)])
  })
```

#### Reflect API

æ•´ä¸ªåå°„ API æš´éœ²äº†å¯¹è±¡è¿è¡Œæ—¶çº§åˆ«çš„å…ƒæ“ä½œï¼Œè¿™å®é™…ä¸Šä¸ Proxy API åˆšå¥½ç›¸åï¼Œå®ƒå…è®¸åœ¨ proxy æ•è·æ—¶è°ƒç”¨ä¸ Proxy æ¥å£ç›¸å¯¹åº”çš„å…ƒæ“ä½œã€‚åœ¨å®ç° proxies æ—¶å°¤å…¶æœ‰ç”¨ã€‚

```js
var O = { a: 1 }
Object.defineProperty(O, 'b', { value: 2 })
O[Symbol('c')] = 3

Reflect.ownKeys(O) // ['a', 'b', Symbol(c)]

function C(a, b) {
  this.c = a + b
}
var instance = Reflect.construct(C, [20, 22])
instance.c // 42
```

#### Tail Calls

å°¾è°ƒç”¨ç¡®ä¿å †æ ˆä¸ä¼šæ— é™å¢é•¿ï¼Œåœ¨é¢å¯¹æ— é™åˆ¶è¾“å…¥æ—¶ç¡®ä¿é€’å½’ç®—æ³•çš„å®‰å…¨ã€‚

```js
function factorial(n, acc = 1) {
    "use strict";
    if (n <= 1) return acc;
    return factorial(n - 1, n * acc);
}

// Stack overflow in most implementations today,
// but safe on arbitrary inputs in ES2015
factorial(100000)
```

## ES2016

ECMAScript 2016 ï¼Œäº 2016 å¹´ 6 æœˆå®Œæˆã€‚

ä¸ ES2015 ç›¸æ¯”ï¼ŒES2016 æ˜¯ JavaScript çš„ä¸€ä¸ªå°ç‰ˆæœ¬ï¼Œä»…åŒ…å«ä¸¤ä¸ªåŠŸèƒ½ï¼š

- Array.prototype.includes
- æ±‚å¹‚è¿ç®—ç¬¦

### Array.prototype.includes()

æ­¤åŠŸèƒ½å¼•å…¥äº†æ›´æ˜“è¯»çš„è¯­æ³•ï¼Œç”¨äºæ£€æŸ¥æ•°ç»„æ˜¯å¦åŒ…å«å…ƒç´ ã€‚è€Œåœ¨ä¹‹å‰éœ€è¦ä½¿ç”¨ `indexOf` æ£€æŸ¥æ•°ç»„ä¸­çš„ç´¢å¼•æ¥åˆ¤æ–­ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨åˆ™è¿”å› -1ã€‚

```js
// ES2015
if ([1, 2].indexOf(3) === -1) {
  console.log('Not found')
}

// ES2016
if (![1, 2].includes(3)) {
  console.log('Not found')
}
```

### æ±‚å¹‚è¿ç®—ç¬¦(\*\*)

æ±‚å¹‚è¿ç®—ç¬¦ `**` ç›¸å½“äº Math.pow()ï¼Œè€Œè¢«ç›´æ¥å¼•å…¥è¯­è¨€æœ¬èº«ï¼Œå¯¹äºæ•°å­¦å¯†é›†å‹çš„ JavaScript åº”ç”¨ç¨‹åºæ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¡¥å……ã€‚

```js
Math.pow(4, 2) === 4 ** 2 // 4*4
```

## ES2017

ECMAScript 2017ï¼ŒECMA-262 æ ‡å‡†ç‰ˆæœ¬çš„ç¬¬ 8 ç‰ˆï¼ˆé€šå¸¸ç§°ä¸º ES2017 æˆ– ES8ï¼‰ï¼Œäº 2017 å¹´ 6 æœˆå®Œæˆã€‚

ä¸ ES6 ç›¸æ¯”ï¼ŒES8 æ˜¯ JavaScript çš„ä¸€ä¸ªå°ç‰ˆæœ¬ï¼Œä½†å®ƒä»ç„¶å¼•å…¥äº†éå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼š

- String padding
- Object.values
- Object.entries
- Object.getOwnPropertyDescriptors()
- å‡½æ•°å‚æ•°åˆ—è¡¨å’Œè°ƒç”¨ä¸­çš„å°¾éšé€—å·
- Async Functions (å¼‚æ­¥å‡½æ•°)
- å…±äº«å†…å­˜ å’Œ atomics

### String padding

å­—ç¬¦ä¸² padding çš„ä½œç”¨æ˜¯å‘å­—ç¬¦ä¸²æ·»åŠ å­—ç¬¦ä½¿å…¶è¾¾åˆ°æŒ‡å®šé•¿åº¦ã€‚

ES2017 å¼•å…¥äº†ä¸¤ä¸ª String æ–¹æ³•ï¼š`padStart()` å’Œ `padEnd()`ã€‚

```js
padStart(targetLength [, padString])
padEnd(targetLength [, padString])
```

```js
'test'.padStart(8)
=> "    test"
'test'.padStart(8,'*')
=> "****test"
'test'.padEnd(8)
=> "test    "
'test'.padEnd(8,'ab')
=> "testabab"
```

### Object.values()

è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯¹è±¡è‡ªèº«å±æ€§å€¼çš„æ•°ç»„ã€‚

```js
const person = { name: 'Fred', age: 87 }
Object.values(person) // ['Fred', 87]

// also works with arrays
const people = ['Fred', 'Tony']
Object.values(people) // ['Fred', 'Tony']
```

### Object.entries()

è¿”å›å¯¹è±¡è‡ªèº«å±æ€§çš„ `[keyï¼Œvalue]` æ•°ç»„

```js
const person = { name: 'Fred', age: 87 }
Object.entries(person) // [['name', 'Fred'], ['age', 87]]

const people = ['Fred', 'Tony']
Object.entries(people) // [['0', 'Fred'], ['1', 'Tony']]

for ([key, val] of Object.entries({ a: 1, b: 2 })) {
  console.log(key, val)
}
```

### getOwnPropertyDescriptors()

è¿”å›ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰è‡ªæœ‰å±æ€§æè¿°ï¼Œæ¯ä¸ªå¯¹è±¡å±æ€§éƒ½æœ‰ä¸€äº›ç‰¹æ€§æè¿°ï¼ŒåŒ…æ‹¬ï¼š

- valueï¼šå±æ€§çš„å€¼
- writableï¼štrue è¡¨ç¤ºè¯¥å±æ€§å¯ä»¥è¢«ä¿®æ”¹
- getï¼šå±æ€§çš„ getter å‡½æ•°ï¼Œåœ¨è¯»å–å±æ€§æ—¶è°ƒç”¨
- setï¼šå±æ€§çš„ setter å‡½æ•°ï¼Œåœ¨å±æ€§è®¾ç½®å€¼æ—¶è°ƒç”¨
- configurableï¼šå¦‚æœä¸º false ï¼Œåˆ™ä¸èƒ½åˆ é™¤å±æ€§ï¼Œä¹Ÿä¸èƒ½æ›´æ”¹ä»»ä½•å±æ€§ï¼Œä½†å€¼é™¤å¤–
- enumerableï¼šå¦‚æœå±æ€§æ˜¯å¯æšä¸¾çš„ï¼Œåˆ™ä¸º true

`Object.getOwnPropertyDescriptors(obj)` æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶è¿”å›å±æ€§æè¿°é›†

```js
Object.getOwnPropertyDescriptors({a:1,b:2,get sum(){return this.a+this.b}});
{
	a: {
		value: 1,
		writable: true,
		enumerable: true,
		configurable: true
	},
	b: {
		value:2,
		writable: true,
		enumerable: true,
		configurable: true
	},
	sum: {
		enumerable: true,
		configurable: true,
		get: f sum(),
		set: undefined
	}
}
```

**é‚£æœ‰å•¥å­ç”¨å‘¢ï¼Ÿ**

ES2015 æä¾›äº† `Object.assign()` ç”¨æ¥æµ…æ‹·è´ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¯æšä¸¾çš„å±æ€§çš„åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¸èƒ½æ‹·è´ `getter setter`

```js
const person1 = {
  set name(newName) {
    console.log(newName)
  },
}
// This wonâ€™t work:
const person2 = {}
Object.assign(person2, person1)

// But this will work:
const person3 = {}
Object.defineProperties(person3, Object.getOwnPropertyDescriptors(person1))
```

```js
person1.name = 'x'
=> "x"
person2.name = 'x' // æ²¡æœ‰è¾“å‡º
person3.name = 'x'
=> "x"
```

person2 ä¸¢å¤±äº† `setter` ï¼Œå› ä¸ºå®ƒæ²¡æœ‰å¤åˆ¶è¿‡æ¥ã€‚ä½¿ç”¨ `Object.create()` å¯¹æµ…æ‹·è´å¯¹è±¡ä¹Ÿæœ‰åŒæ ·çš„é™åˆ¶ã€‚

### Trailing commas

æ­¤åŠŸèƒ½å…è®¸åœ¨å‡½æ•°å£°æ˜å’Œå‡½æ•°è°ƒç”¨ä¸­ä½¿ç”¨å°¾éšé€—å·ï¼š

```
const doSomething = (var1, var2,) => {
  //...
}
doSomething('test2', 'test2',)
```

### Async functions

è¿™æ˜¯æœ€é‡è¦æœ€æœ‰ç”¨çš„ä¸€ä¸ªç‰¹æ€§ã€‚å¼‚æ­¥å‡½æ•°å¯ä»¥é¿å…å›è°ƒåœ°ç‹±ï¼Œå¹¶è®©æ•´ä¸ªä»£ç çœ‹èµ·æ¥æ›´ç®€å•ã€‚

å¼‚æ­¥å‡½æ•°æ˜¯ promises å’Œ generators çš„ç»„åˆï¼Œä»¥ç®€åŒ– promises è°ƒç”¨ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œä½†æ˜¯ä¸æ‰“ç ´ promises é“¾å¼è°ƒç”¨çš„é™åˆ¶ã€‚

async å…³é”®å­—å‘Šè¯‰ JavaScript ç¼–è¯‘å™¨è¦ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†è¿™ä¸ªå‡½æ•°ã€‚åœ¨é‡åˆ°å‡½æ•°ä¸­çš„ await å…³é”®å­—æ—¶ï¼Œç¼–è¯‘å™¨å°±ä¼šæš‚åœã€‚å®ƒå‡å®š await ä¹‹åçš„è¡¨è¾¾å¼ä¼šè¿”å›ä¸€ä¸ª promise å¹¶ç­‰å¾…ï¼Œç›´åˆ° promise å®Œæˆæˆ–è¢«æ‹’ç»ã€‚

```js
function doSomethingAsync() {
	return new Promise(resolve => {
		setTimeout(() => resolve('I did something'), 3000)
	})
}
async function doSomething() {
	console.log(await doSomethingAsync())
}
console.log('Before')
doSomething()
console.log('After')

=> Before
=> After
=> I did something // after 3s
```

å¼‚æ­¥å‡½æ•°å¯ä»¥éå¸¸å®¹æ˜“åœ°é“¾å¼è°ƒç”¨ï¼Œå¹¶ä¸”è¯­æ³•æ¯” Promise æ›´å…·å¯è¯»æ€§ï¼š

```js
function promiseToDoSomething() {
  return new Promise(resolve => {
    setTimeout(() => resolve('I did something'), 10000)
  })
}
async function watchOverSomeoneDoingSomething() {
  const something = await promiseToDoSomething()
  return something + ' and I watched'
}
async function watchOverSomeoneWatchingSomeoneDoingSomething() {
  const something = await watchOverSomeoneDoingSomething()
  return something + ' and I watched as well'
}
watchOverSomeoneWatchingSomeoneDoingSomething().then(res => {
  console.log(res)
})
```

### Shared Memory and Atomics

WebWorkers ç”¨äºåœ¨æµè§ˆå™¨ä¸­åˆ›å»ºå¤šçº¿ç¨‹ç¨‹åºã€‚ä½†æˆ‘ä»¬å¦‚æœæƒ³åœ¨ä¸» JS çº¿ç¨‹å’Œ WebWorkers ä¹‹é—´å…±äº«æ•°æ®ï¼Œå¿…é¡»å¤åˆ¶æ•°æ®ï¼Œå¹¶ä½¿ç”¨ postMessage å°†æ•°æ®å‘é€ç»™å¦ä¸€ä¸ªçº¿ç¨‹ã€‚

è¿™ä¸ªé«˜çº§ç‰¹æ€§ï¼Œæ˜¯ JS å¼•æ“çš„æ ¸å¿ƒå¢å¼ºã€‚ä¸»è¦çš„æƒ³æ³•æ˜¯å°†æŸç§å¤šçº¿ç¨‹ç‰¹æ€§å¼•å…¥åˆ° JavaScript ä¸­ï¼Œè®© JS å¼€å‘äººå‘˜å¯ä»¥è‡ªå·±ç®¡ç†å†…å­˜ï¼Œç¼–å†™é«˜æ€§èƒ½çš„å¹¶å‘ç¨‹åºã€‚

è¿™æ˜¯é€šè¿‡ä¸€ä¸ªå«ä½œ `SharedArrayBuffer` çš„å…¨å±€å¯¹è±¡æ¥å®ç°çš„ï¼Œè¿™ä¸ªå¯¹è±¡å®è´¨ä¸Šå°†æ•°æ®å­˜å‚¨åœ¨å…±äº«å†…å­˜ä¸­ã€‚å› æ­¤ï¼Œè¿™äº›æ•°æ®å¯ä»¥åœ¨ä¸» JS çº¿ç¨‹å’Œ WebWorkers å·¥ä½œçº¿ç¨‹ä¹‹é—´å…±äº«ã€‚

ä½†åœ¨çº¿ç¨‹ä¹‹é—´å…±äº«å†…å­˜ä¼šå¯¼è‡´ç«æ€æ¡ä»¶ã€‚ä¸ºäº†é¿å…ç«æ€æ¡ä»¶ï¼Œå¼•å…¥äº† `Atomics` å…¨å±€å¯¹è±¡ã€‚`Atomics` æä¾›äº†å„ç§æ–¹æ³•æ¥åœ¨çº¿ç¨‹ä½¿ç”¨æ•°æ®æ—¶é”å®šå…±äº«å†…å­˜ï¼Œè¿˜æä¾›äº†å®‰å…¨æ›´æ–°å…±äº«å†…å­˜æ•°æ®çš„æ–¹æ³•ã€‚

## ES2018

### Rest/Spread Properties

ES6 åœ¨å¤„ç†æ•°ç»„è§£æ„æ—¶,å¼•å…¥äº† rest(å‰©ä½™)å…ƒç´ çš„æ¦‚å¿µï¼Œä¾‹å¦‚ï¼š

```js
const numbers = [1, 2, 3, 4, 5]
[first, second, ...others] = numbers
```

è¿˜æœ‰å±•å¼€å…ƒç´ æ—¶ï¼š

```js
const numbers = [1, 2, 3, 4, 5]
const sum = (a, b, c, d, e) => a + b + c + d + e
const sum = sum(...numbers)
```

ES2018 ä¸ºå¯¹è±¡å¼•å…¥äº†ç±»ä¼¼çš„åŠŸèƒ½ã€‚

```js
const { first, second, ...others } = {
  first: 1,
  second: 2,
  third: 3,
  fourth: 4,
  fifth: 5,
}
first // 1
second // 2
others // { third: 3, fourth: 4, fifth: 5 }

const items = { first, second, ...others }
items //{ first: 1, second: 2, third: 3, fourth: 4, fifth: 5 }
```

### Asynchronous iteration

æ–°çš„ `for-await-of` æ„é€ å…è®¸æ‚¨ä½¿ç”¨å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡ä½œä¸ºå¾ªç¯è¿­ä»£ï¼š

```js
for await (const line of readLines(filePath)) {
  console.log(line)
}
```

ç”±äºè¿™ä½¿ç”¨ await ï¼Œä½ åªèƒ½åœ¨å¼‚æ­¥å‡½æ•°ä¸­ä½¿ç”¨å®ƒï¼Œå°±åƒæ™®é€šçš„ await ä¸€æ ·

### Promise.prototype.finally()

å½“ Promise å®Œæˆï¼ŒæˆåŠŸä¹‹åä¼šä¸€ä¸ªæ¥ç€ä¸€ä¸ªè°ƒç”¨ `then()`ï¼Œå¦‚æœå¤±è´¥åˆ™è·³è¿‡`then()`ï¼Œæ‰§è¡Œ`catch()`.

`finally()` å…è®¸ä½ æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½å¯ä»¥è¿è¡Œä¸€æ®µä»£ç 

```js
fetch('file.json')
  .then(data => data.json())
  .catch(error => console.error(error))
  .finally(() => console.log('finished'))
```

### Regular Expression improvements

#### Lookbehinds

æ­£åˆ™è¡¨è¾¾å¼æ”¹è¿›ï¼Œå¢åŠ äº†åè¡Œæ–­è¨€(lookbehinds)ï¼šæ ¹æ®å‰é¢çš„å†…å®¹åŒ¹é…å­—ç¬¦ä¸²ã€‚

å…ˆæ¥çœ‹ä¸‹å…ˆè¡Œæ–­è¨€(lookahead)ï¼šæ‚¨å¯ä»¥ä½¿ç”¨ `?=` åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²åé¢è·Ÿç€ä¸€ä¸ªç‰¹å®šçš„å­å­—ç¬¦ä¸²ï¼š

```js
/Roger(?=Waters)/
/Roger(?= Waters)/.test('Roger is my dog') //false
/Roger(?= Waters)/.test('Roger Waters is a famous musician') //true
```

`?!` æ‰§è¡Œé€†æ“ä½œï¼ŒåŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²åé¢æ²¡æœ‰ä¸€ä¸ªç‰¹å®šçš„å­å­—ç¬¦ä¸²ï¼š

```js
/Roger(?!Waters)/
/Roger(?! Waters)/.test('Roger is my dog') //true
/Roger(?! Waters)/.test('Roger Waters is a famous musician') //false
```

å…ˆè¡Œæ–­è¨€(lookahead)ä½¿ç”¨ `?=` ç¬¦å·ã€‚å®ƒä»¬å·²ç»å¯ç”¨äº†ã€‚

**åè¡Œæ–­è¨€(lookbehinds)**ï¼Œæ˜¯ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œä½¿ç”¨ `?<=`

```js
/(?<=Roger) Waters/
/(?<=Roger) Waters/.test('Pink Waters is my dog') //false
/(?<=Roger) Waters/.test('Roger Waters is a famous musician') //true
```

åè¡Œæ–­è¨€(lookbehind) é€†æ“ä½œï¼Œä½¿ç”¨ `?<!`

```js
/(?<!Roger) Waters/
/(?<!Roger) Waters/.test('Pink Waters is my dog') //true
/(?<!Roger) Waters/.test('Roger Waters is a famous musician') //false
```

ä¸ç®¡æ˜¯å…ˆè¡Œæ–­è¨€è¿˜æ˜¯åè¡Œæ–­è¨€ï¼ŒåŒ¹é…å†…å®¹éƒ½ä¸åŒ…æ‹¬æ–­è¨€æœ¬èº«

```js
'Roger Waters is a famous musician'.match(/Roger (?=Waters)/)[0] // Roger
'Roger Waters is a famous musician'.match(/(?<=Roger) Waters/)[0] // Waters
```

#### Unicode property escapes \p{â€¦} and \P{â€¦}

åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `\d` åŒ¹é…ä»»ä½•æ•°å­—ï¼Œ`\s` åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼Œ\w åŒ¹é…ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼Œä¾æ­¤ç±»æ¨ã€‚

è¿™ä¸ªæ–°åŠŸèƒ½å°†æ‰©å±•æ­¤æ¦‚å¿µå¼•å…¥ `\p{}` åŒ¹é…æ‰€æœ‰ Unicode å­—ç¬¦ï¼Œå¦å®šå½¢å¼ä¸º `\P{}` ã€‚

ä»»ä½• Unicode å­—ç¬¦éƒ½æœ‰ä¸€ç»„å±æ€§ã€‚ ä¾‹å¦‚ï¼Œ`Script` ç¡®å®šè¯­è¨€ç³»åˆ—ï¼Œ`ASCII` æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œ å¯¹äº `ASCII` å­—ç¬¦ï¼Œå€¼ä¸º trueï¼Œä¾æ­¤ç±»æ¨ã€‚ æ‚¨å¯ä»¥å°†æ­¤å±æ€§æ”¾åœ¨èŠ±æ‹¬å·ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼å°†æ£€æŸ¥æ˜¯å¦ä¸ºçœŸï¼š

```js
/^\p{ASCII}+$/u.test('abc')   //âœ…
/^\p{ASCII}+$/u.test('ABC@')  //âœ…
/^\p{ASCII}+$/u.test('ABCğŸ™ƒ') //âŒ
```

`ASCII_Hex_Digit` æ˜¯å¦ä¸€ä¸ªå¸ƒå°”å±æ€§ï¼Œç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»…åŒ…å«æœ‰æ•ˆçš„åå…­è¿›åˆ¶æ•°å­—ï¼š

```js
/^\p{ASCII_Hex_Digit}+$/u.test('0123456789ABCDEF') //âœ…
/^\p{ASCII_Hex_Digit}+$/u.test('h')                //âŒ
```

è¿˜æœ‰è®¸å¤šå…¶ä»–å¸ƒå°”å±æ€§ï¼Œæ‚¨åªéœ€é€šè¿‡åœ¨èŠ±æ‹¬å·ä¸­æ·»åŠ å®ƒä»¬çš„åç§°æ¥æ£€æŸ¥å®ƒä»¬ï¼ŒåŒ…æ‹¬ `Uppercase`, `Lowercase`, `White_Space`, `Alphabetic`, `Emoji` ç­‰ï¼š

```js
/^\p{Lowercase}$/u.test('h') //âœ…
/^\p{Uppercase}$/u.test('H') //âœ…
/^\p{Emoji}+$/u.test('H')   //âŒ
/^\p{Emoji}+$/u.test('ğŸ™ƒğŸ™ƒ') //âœ…
```

é™¤äº†è¿™äº›äºŒè¿›åˆ¶å±æ€§ä¹‹å¤–ï¼Œæ‚¨è¿˜å¯ä»¥æ£€æŸ¥ä»»ä½• unicode å­—ç¬¦å±æ€§ä»¥åŒ¹é…ç‰¹å®šå€¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯ç”¨å¸Œè…Šè¯­è¿˜æ˜¯æ‹‰ä¸å­—æ¯å†™çš„

```js
/^\p{Script=Greek}+$/u.test('ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬') //âœ…
/^\p{Script=Latin}+$/u.test('hey') //âœ…
```

#### Named capturing groups

åœ¨ ES2018 ä¸­ï¼Œæ­£åˆ™åŒ¹é…å¯ä»¥ä¸ºæ•è·ç»„èµ·ä¸ªåç§°

```js
const re = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/
const result = re.exec('2015-01-02')
// result.groups.year === '2015';
// result.groups.month === '01';
// result.groups.day === '02';
```

#### The 'sâ€™ flag for regular expressions

`s` æ ‡å¿— single line çš„ç¼©å†™ï¼Œå®ƒä½¿å¾— `.` å¯ä»¥åŒ¹é…æ¢è¡Œ `\r \n`

```js
;/hi.welcome/.test('hi\nwelcome') // false
;/hi.welcome/s.test('hi\nwelcome') // true
```

## è¯æ±‡ç»“æ„

### Unicode

JavaScript æ˜¯ç”¨ Unicode ç¼–å†™çš„ã€‚ è¿™æ„å‘³ç€æ‚¨ç”¨ä»»ä½•è¯­è¨€ç¼–å†™æ ‡è¯†ç¬¦ã€‚æ³¨æ„ï¼šemoji ä¸å¯ä»¥ã€‚

```js
// How convenient!
var Ï€ = Math.PI
var Î» = function() {}
var à² _à²  = eval
var lolwat = 'heh'
var fooâ€Œbar = 42
var ã€±ã€± = 2
ã€±ã€± << ã€±ã€± // 8
var å“ˆ = 1
// Fun with Roman numerals
var â…£ = 4
var â…¤ = 5
â…£ + â…¤ // 9
var ğŸ˜ƒ = 1 // ä¼šæŠ¥é”™ Uncaught SyntaxError: Invalid or unexpected toke
```

### åˆ†å·

JavaScript å…·æœ‰éå¸¸ç±»ä¼¼äº C çš„è¯­æ³•ï¼Œä½†æ˜¯åˆ†å·å¹¶ä¸æ˜¯å¼ºåˆ¶çš„ï¼Œæ–°è®¾è®¡çš„è¯­è¨€é‡Œå¯é€‰åˆ†å·çš„å¾ˆå¤šï¼Œå…‰æ˜¯ â€œå¯ä»¥åŠ åˆ†å·ä½†æ˜¯å¤§å®¶éƒ½ä¸åŠ â€ çš„è¯­è¨€å°±æœ‰ï¼šGo, Scala, Ruby, Python, Swift, Groovy ç­‰ç­‰ï¼Œæ‰€ä»¥åŠ ä¸åŠ åˆ†å·çº¯çœ‹ä¸ªäººå–œæ¬¢ã€‚

çœŸæ­£ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡è§£æå‡ºé—®é¢˜çš„ token æœ‰ 5 ä¸ªï¼šæ‹¬å·ï¼Œæ–¹æ‹¬å·ï¼Œæ­£åˆ™å¼€å¤´çš„æ–œæ ï¼ŒåŠ å·ï¼Œå‡å·ã€‚å½“ä»¥è¿™äº›å¼€å¤´æ—¶éœ€è¦åŠ åˆ†å·ï¼Œè€Œè¿™ç§æƒ…å†µå¾ˆå°‘è§ï¼Œå³ä½¿å‡ºç° linter ä¹Ÿä¼šæ£€æŸ¥å‡ºæ¥ã€‚
è¿˜æœ‰å°±æ˜¯è§„é¿ return æ¢è¡Œé—®é¢˜ã€‚

æ‰€ä»¥ç°åœ¨å¾ˆå¤šå¼€æºåº“ä»£ç éƒ½ä¸å†™æ— æ„ä¹‰çš„åˆ†å·ã€‚

### ç©ºæ ¼

JavaScript ä¸è®¤ä¸ºç©ºæ ¼æœ‰æ„ä¹‰ã€‚å¤šä½™çš„ç©ºæ ¼ä¹Ÿä¼šè¢«æ ¼å¼åŒ–ã€å‹ç¼©å·¥å…·ç­‰å‰”æ‰ï¼Œç©ºæ ¼åªä¸è¿‡å¯ä»¥ä¿æŒä»£ç çš„å¯è¯»æ€§ï¼Œæ¯”å¦‚ä¸¤ä¸ªç©ºæ ¼ç¼©è¿›ã€‚

### å¤§å°å†™æ•æ„Ÿ

JavaScript æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚å˜é‡ `name` å’Œ `Name` æ˜¯ä¸ä¸€æ ·çš„ã€‚

### æ³¨é‡Š

ä¸¤ç§æ³¨é‡Šå½¢å¼

```js
/* å¤šè¡Œæ³¨é‡Š */
// å•è¡Œæ³¨é‡Š
```

### å­—é¢é‡å’Œæ ‡è¯†ç¬¦

**å­—é¢é‡**ï¼šæˆ‘ä»¬å°†æºä»£ç ä¸­ç¼–å†™çš„å€¼ç§°ä¸ºå­—é¢é‡ï¼Œä¾‹å¦‚æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå¸ƒå°”æˆ–æ›´é«˜çº§çš„æ„é€ ï¼Œå¦‚ å¯¹è±¡å­—é¢é‡ æˆ– æ•°ç»„å­—é¢é‡ï¼š

```js
5
'Test'
true
['a', 'b']
{color: 'red', shape: 'Rectangle'}
```

**æ ‡è¯†ç¬¦**ï¼šç”¨äºæ ‡è¯†å˜é‡ï¼Œå‡½æ•°ï¼Œå¯¹è±¡çš„å­—ç¬¦åºåˆ—ï¼Œåªèƒ½åŒ…å«å­—æ¯æˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿ï¼ˆâ€œ\_â€ï¼‰å’Œç¾å…ƒç¬¦å·ï¼ˆâ€œ\$â€ï¼‰ï¼Œä¸”ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ã€‚åŒºåˆ†å¤§å°å†™ã€‚

```js
test
TEST
_test
Test1
$test
```

### ä¿ç•™å­—

ä½ ä¸èƒ½ä½¿ç”¨ä¸‹åˆ—æ ‡è¯†ç¬¦ï¼Œå› ä¸ºä»–ä»¬æ˜¯è¯­è¨€ä¿ç•™å­—ã€‚

```js
break
do
instanceof
typeof
case
else
new
var
catch
finally
return
void
continue
for
switch
while
debugger
function
this
with
default
if
throw
delete
in
try
class
enum
extends
super
const
export
import
implements
let
private
public
interface
package
protected
static
yield
```

## å˜é‡

